<% @flash = flash -%>
<div id="flash"><%= render :partial => 'layouts/flash' -%></div>

<div class="header" id="navtop">
  <div class="navbar <%= @show_image.present? ? 'navbar-transparent' : 'navbar-default' %>" role="navigation">
    <div class="container-fluid">
      <div class="navbar-header"
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="/">
          <%= content_tag :span,  ENV['SITE_TITLE'], data_tags_for_api %>
        </a>
      </div>
      <div class="navbar-collapse collapse">
        <ul class="nav navbar-nav navbar-right">
          <% if can?(:read, Service) %>
            <li class="dropdown hidden-sm hidden-md">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">Admin <span class="caret"></span></a>
              <ul class="dropdown-menu">
                <% if can?(:manage, User) %>
                  <li><%= link_to "Users", users_path %></li>
                <% end %>
                <% if can?(:manage, Claim) %>
                  <li><%= link_to "Claims", claims_path %></li>
                <% end %>
                <% if can?(:manage, Member) %>
                  <li><%= link_to "Members", members_path %></li>
                <% end %>
                <% if can?(:manage, Service) %>
                  <li><%= link_to "Services", services_path %></li>
                <% end %>
                <% if can?(:read, Tag) %>
                  <li><%= link_to "Tags", tags_path %></li>
                <% end %>
                <li><%= link_to "Status", status_index_path %></li>
              </ul>
            </li>
          <% end %>
          <li class="dropdown hidden-sm hidden-md">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Support <span class="caret"></span></a>
            <ul class="dropdown-menu" role="menu">
              <li><%= link_to "Email", "mailto:support@datacite.org" %></li>
              <li><%= link_to "Source Code", ENV['GITHUB_URL'] %></li>
            </ul>
          </li>
          <li class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown" id="account_menu_link"><%= icon('th') %> <span class="caret"></span></a>
            <ul class="dropdown-menu" role="menu">
              <% if Rails.env.development? %>
                <% settings.development_links.each do |item| %>
                  <li><%= link_to "#{icon(item['icon'])} #{item['name']}".html_safe, item['url'] %></li>
                <% end %>
              <% else %>
                <% settings.production_links.each do |item| %>
                  <li><%= link_to "#{icon(item['icon'])} #{item['name']}".html_safe, item['url'] %></li>
                <% end %>
              <% end %>
            </ul>
          </li>
          <% if user_signed_in? %>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown" id="account_menu_link"><%= current_user.display_name %> <span class="caret"></span></a>
              <ul class="dropdown-menu" role="menu">
                <li><%= link_to "#{icon('user')} Settings".html_safe, user_path("me") %></li>
                <% if ENV['ORCID_CLIENT_ID'].present? %>
                  <li class="divider"></li>
                  <li><%= link_to "#{icon('external-link')} ORCID Record".html_safe, current_user.orcid %></li>
                <% end %>
                <li class="divider"></li>
                <li><%= link_to "#{icon('sign-out')} Sign Out".html_safe, destroy_user_session_path, :id => "sign_out" %></li>
              </ul>
            </li>
          <% elsif !["sessions","registrations"].include?(controller.controller_name) %>
            <li><%= link_to "#{icon('sign-in')} Sign In".html_safe, new_session_path, :id => "sign-in", class: 'btn btn-default' %></li>
          <% end %>
        </ul>
      </div>
    </div>
  </div>
</div>
